<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Create Task</title>

    <!-- Link CSS t√°ch ri√™ng -->
    <link rel="stylesheet" href="../static/addtask.css">
</head>

<body>

    <div class="task-form">
        <h2 id="formTitle">üìù NEW TASK</h2>

        <label>Title</label>
        <input id="title" type="text" placeholder="Re-enter title!...">

        <label>Content</label>
        <textarea id="content" placeholder="Please enter the content!..."></textarea>

        <label>Date</label>
        <input id="date" type="date">

        <label>Time</label>
        <input id="time" type="time">

        <div class="btn-area">
            <button class="back-btn" onclick="window.location.href='taskflow_search.html'">‚¨ÖBack</button>
            <button class="save-btn" onclick="saveTask()">Save Task</button>
        </div>
    </div>


<script>
// Load data if editing
document.addEventListener("DOMContentLoaded", () => {
    const editIndex = localStorage.getItem("editTaskIndex");
    if (editIndex !== null) {
        document.getElementById("formTitle").innerText = "üìù Edit Task";
        const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
        const task = tasks[editIndex];
        if (task) {
            document.getElementById("title").value = task.title;
            document.getElementById("content").value = task.content;
            document.getElementById("date").value = task.date;
            document.getElementById("time").value = task.time;
        }
    }
});

function saveTask() {
    const title = document.getElementById("title").value.trim();
    const content = document.getElementById("content").value.trim();
    const date = document.getElementById("date").value;
    const time = document.getElementById("time").value;

    if (!title) return alert("Re-enter title!");
    if (!content) return alert("Please enter the content!");
    if (!date) return alert("Please enter the date!");
    if (!time) return alert("Please enter the time!");

    const task = { title, content, date, time };

    let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
    
    const editIndex = localStorage.getItem("editTaskIndex");

    if (editIndex !== null) {
        // Update existing task
        tasks[editIndex] = task;
        localStorage.removeItem("editTaskIndex"); // Clear edit mode
        alert("Task successfully fixed!");
    } else {
        // Add new task
        tasks.push(task);
        alert("Task added successfully!");
    }

    localStorage.setItem("tasks", JSON.stringify(tasks));
    window.location.href = "taskflow_search.html";
}
</script>

</body>
</html>

